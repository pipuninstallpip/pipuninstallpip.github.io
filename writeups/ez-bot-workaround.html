<!DOCTYPE html>
<html>
  <head>
    <title>Discord Bot Workaround Writeup - pip uninstall pip</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, height=device-height"
    />
    <link rel="stylesheet" href="../index.css" />
    <link rel="stylesheet" href="./writeup.css" />
  </head>
  <body>
    <div id="content-container">
      <nav class="navbar">
        <a href="../">Home</a>
        <br/>
        <a href="#">Writeups</a>
      </nav>
      <div id="main-container">
        <div id="header" role="heading" aria-level="1">
          <h1>Discord Bot Workaround Writeup</h1>
        </div>

        <main>
          <p>
            Fun fact - this was a real vulnerability in ez.ctf.cafe that let me
            view the challenges and submit flags through the bot before the
            challenge had started.
          </p>
          <p>
            To do this, you need to enable developer mode in your user settings
            to get Cafe Bot's ID. Then, right click its profile for the ID
            <code>971520199515836456</code>.
          </p>
          <p>
            Now, we take a random bot's invite link from top.gg, like Mudae's:
            https://discord.com/oauth2/authorize?client_id=432610292342587392&amp;permissions=537159744&amp;scope=applications.commands%20bot,
            and change the ID to @Cafe Bot's ID.
          </p>
          <p>
            I'll also change <code>applications.commands%20bot</code> to
            <code>bot</code>, meaning we're no longer requesting slash command
            permissions, but still adding it as a bot, and changing
            <code>permissions= . . .</code> to <code>permissions=8</code> to
            give the bot full administrator permissions.
          </p>
          <p>
            Now we have our invite:
            https://discord.com/oauth2/authorize?client_id=971520199515836456&amp;permissions=8&amp;scope=bot
          </p>
          <p>
            Now, add this bot to any server where you have administrator
            permissions, and run <code>?flag</code> in that server. It should
            give you the flag!
          </p>
          <p>
            I didn't use it at the time, but another member of the EZ-CTF
            Discord server suggested using
            https://discordapi.com/permissions.html to create the invite, and
            I'd agree that it's much more efficient.
          </p>
          <p>
            If you're making a bot and want to prevent this, disable the "Public
            Bot" option in your app's config on https://discord.com/developers.
            This will make sure that only you can add the bot to a server.
          </p>
        </main>
      </div>
    </div>
  </body>
</html>
